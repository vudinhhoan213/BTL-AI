<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TÃ¬m Ä‘Æ°á»ng Ä‘i Ä‘á»ƒ cá»©u há»™- Háº¡ ÄÃ¬nh</title>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />

    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <div class="layout">
      <aside class="sidebar">
        <h1>ğŸ“ TÃ¬m Ä‘Æ°á»ng nÃ© Ä‘iá»ƒm ngáº­p</h1>

        <section>
          <p class="hint">
            <strong>Khu vá»±c:</strong> Háº¡ ÄÃ¬nh, Thanh XuÃ¢n.<br />
            Sá»­ dá»¥ng dá»¯ liá»‡u Ä‘á»“ thá»‹ trá»ng sá»‘ Ä‘á»ƒ tá»± Ä‘á»™ng nÃ© cÃ¡c Ä‘oáº¡n Ä‘Æ°á»ng bá»‹ Ä‘Ã¡nh
            dáº¥u ngáº­p.
          </p>
          <button id="load-map-btn" class="secondary" style="width: 100%">
            ğŸ”„ Táº£i láº¡i báº£n Ä‘á»“
          </button>
        </section>

        <section class="selection">
          <h2>1. Thiáº¿t láº­p lá»™ trÃ¬nh</h2>
          <div class="selection-buttons">
            <button
              id="btn-start"
              class="mode-btn active"
              data-mode="start"
              onclick="setSelectionMode('start')"
            >
              ğŸŸ¢ Chá»n Ä‘iá»ƒm Ä‘i (S)
            </button>
            <button
              id="btn-goal"
              class="mode-btn"
              data-mode="goal"
              onclick="setSelectionMode('goal')"
            >
              ğŸ”´ Chá»n Ä‘iá»ƒm Ä‘Ã­ch (G)
            </button>
          </div>

          <div class="coords">
            <div>
              <strong>Xuáº¥t phÃ¡t:</strong>
              <span id="start-display">ChÆ°a chá»n</span>
            </div>
            <div>
              <strong>ÄÃ­ch:</strong> <span id="goal-display">ChÆ°a chá»n</span>
            </div>
          </div>

          <h2>2. Cáº­p nháº­t tÃ¬nh tráº¡ng ngáº­p</h2>
          <div class="selection-buttons">
            <button
              id="btn-flood"
              class="mode-btn btn-flood"
              data-mode="flood"
              onclick="setSelectionMode('flood')"
            >
              âš ï¸ ÄÃ¡nh dáº¥u Ä‘oáº¡n ngáº­p (Click 2 Ä‘iá»ƒm)
            </button>
            <button onclick="clearAllFloods()" class="secondary">
              ğŸ§¹ XÃ³a táº¥t cáº£ Ä‘iá»ƒm ngáº­p
            </button>
          </div>

          <h2>3. Thá»±c thi</h2>
          <label for="algorithm-select">Chá»n thuáº­t toÃ¡n:</label>
          <select id="algorithm-select">
            <option value="astar">Thuáº­t toÃ¡n A* (Tá»‘i Æ°u nháº¥t)</option>
            <option value="dijkstra">Thuáº­t toÃ¡n Dijkstra</option>
            <option value="bfs">BFS (Ngáº¯n nháº¥t theo sá»‘ bÆ°á»›c)</option>
          </select>

          <button
            id="run-btn"
            class="primary"
            style="width: 100%; margin-top: 10px"
          >
            ğŸš€ Báº®T Äáº¦U TÃŒM ÄÆ¯á»œNG
          </button>

          <div id="error-box" class="error" role="alert" hidden></div>
        </section>

        <section>
          <h2>4. Káº¿t quáº£ lá»™ trÃ¬nh</h2>
          <div id="result-panel">
            ChÆ°a cÃ³ lá»™ trÃ¬nh. HÃ£y chá»n cÃ¡c Ä‘iá»ƒm trÃªn báº£n Ä‘á»“ vÃ  nháº¥n Cháº¡y.
          </div>
        </section>

        <div class="graph-summary">
          <strong>Äá»“ thá»‹:</strong>
          <span id="graph-summary">Äang táº£i dá»¯ liá»‡u...</span>
        </div>
        <textarea id="graphml-output" style="display: none"></textarea>
        <button
          id="download-graph-btn"
          class="secondary"
          style="font-size: 0.8rem; margin-top: 20px"
        >
          ğŸ’¾ Táº£i GraphML
        </button>
      </aside>

      <main id="map"></main>
    </div>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script>
      // Logic Ä‘á»“ng bá»™ UI
      function updateUIActiveMode(mode) {
        document.querySelectorAll(".mode-btn").forEach((btn) => {
          if (btn.getAttribute("data-mode") === mode) {
            btn.classList.add("active");
          } else {
            btn.classList.remove("active");
          }
        });
      }

      // Bá»c láº¡i hÃ m Ä‘á»ƒ cáº­p nháº­t giao diá»‡n khi thay Ä‘á»•i cháº¿ Ä‘á»™
      const originalSetMode = window.setSelectionMode;
      window.setSelectionMode = function (mode) {
        if (typeof originalSetMode === "function") {
          originalSetMode(mode);
        }
        updateUIActiveMode(mode);
      };

      // Máº·c Ä‘á»‹nh chá»n cháº¿ Ä‘á»™ 'start' khi vá»«a táº£i trang
      window.onload = function () {
        setSelectionMode("start");
      };
    </script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
  </body>
</html>
